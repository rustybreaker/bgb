<!DOCTYPE html>
<html lang="pt-br">
<head>
  {% load static %}
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Surpresa pra Bia{% endblock %}</title>

  <!-- Bloco para CSS extra -->
  {% block style %}{% endblock %}
</head>
<body>

  <!-- ðŸŽµ MÃºsica global (nÃ£o reinicia entre pÃ¡ginas) -->
  <audio id="musica-global" loop>
    <source src="{% static 'musica.mp3' %}" type="audio/mpeg">
  </audio>

  <!-- ConteÃºdo de cada pÃ¡gina -->
  {% block content %}{% endblock %}

  <!-- Script para tocar a mÃºsica uma vez e manter entre pÃ¡ginas -->
  <script>
    const musica = document.getElementById("musica-global");
    const tocando = localStorage.getItem("musica_tocando");

    if (tocando !== "sim") {
      musica.muted = false;
      const play = musica.play();

      if (play !== undefined) {
        play
          .then(() => localStorage.setItem("musica_tocando", "sim"))
          .catch(() => {
            document.body.addEventListener("click", () => {
              musica.play();
              localStorage.setItem("musica_tocando", "sim");
            }, { once: true });
          });
      }
    }

    window.addEventListener("beforeunload", () => {
      localStorage.setItem("musica_tocando", "sim");
    });
  </script>

  <!-- Bloco para JS extra -->
  {% block script %}{% endblock %}

</body>
</html>
